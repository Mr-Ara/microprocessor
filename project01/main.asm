.INCLUDE "M32def.inc"
LDI R16,HIGH(RAMEND)
OUT SPH,R16
LDI R16,LOW(RAMEND)
OUT SPL,R16

//Testing
LDI R20, 0
LDI R21, 3
LDI R22, 4
CALL MainFunction
LDI R20, 0
LDI R21, 5
LDI R22, 17
CALL MainFunction
LDI R20, 0
LDI R21, 18
LDI R22, 6
CALL MainFunction
LDI R20, 1
LDI R21, 3
LDI R22, 4
CALL MainFunction
LDI R20, 1
LDI R21, 5
LDI R22, 17
CALL MainFunction
LDI R20, 1
LDI R21, 18
LDI R22, 6
CALL MainFunction
LDI R20, 2
LDI R21, 3
LDI R22, 4
CALL MainFunction
LDI R20, 2
LDI R21, 57
LDI R22, 9
CALL MainFunction
LDI R20, 2
LDI R21, 113
LDI R22, 25
CALL MainFunction
LDI R20, 3
LDI R21, 47
LDI R22, 2
CALL MainFunction
LDI R20, 3
LDI R21, 72
LDI R22, 4
CALL MainFunction
LDI R20, 3
LDI R21, 13
LDI R22, 13
CALL MainFunction
LDI R20, 4
LDI R21, 3
LDI R22, 4
CALL MainFunction
LDI R20, 4
LDI R21, 13
LDI R22, 4
CALL MainFunction
LDI R20, 4
LDI R21, 26
LDI R22, 4
CALL MainFunction
LDI R20, 4
LDI R21, 120
LDI R22, 4
CALL MainFunction
LDI R20, 5
LDI R21, 3
LDI R22, 10
CALL MainFunction
LDI R20, 5
LDI R21, 120
LDI R22, 180
CALL MainFunction
LDI R20, 5
LDI R21, 90
LDI R22, 95
CALL MainFunction
LDI R20, 6
LDI R21, 3
LDI R22, 10
CALL MainFunction
LDI R20, 6
LDI R21, 120
LDI R22, 180
CALL MainFunction
LDI R20, 6
LDI R21, 90
LDI R22, 95
CALL MainFunction
LDI R20, 7
LDI R21, 3
LDI R22, 10
CALL MainFunction
LDI R20, 7
LDI R21, 120
LDI R22, 180
CALL MainFunction
LDI R20, 7
LDI R21, 90
LDI R22, 95
CALL MainFunction
LDI R20, 8
LDI R21, 3
LDI R22, 10
CALL MainFunction
LDI R20, 8
LDI R21, 120
LDI R22, 180
CALL MainFunction
LDI R20, 8
LDI R21, 90
LDI R22, 95
CALL MainFunction

//End of test








MainFunction: 
TST R20
BREQ L0
DEC R20
BREQ L1
DEC R20
BREQ L2
DEC R20
BREQ L3
DEC R20
BREQ L4
DEC R20
BREQ L5
DEC R20
BRNE C1
JMP L6
C1:
DEC R20
BRNE C2
JMP L7
C2:
JMP L8




L0: 
MOV R18,R21
MOV R19,R22
SUB R18,R19
BRSH N0
MOV R16,R22
MOV R17,R21
JMP EXT
N0: 
MOV R16,R21
MOV R17,R22
JMP EXT


L1: 
MUL R21,R22
MOV R16,R0
JMP EXT

L2:
MOV R18,R21
MOV R19,R22
LDI R23,0
N1:
INC R23
SUB R18,R19
BRSH N1
DEC R23
ADD R18,R19
MOV R16,R23
MOV R17,R18
JMP EXT

L3:
MOV R18,R21
MOV R19,R22
N2:
SUB R18,R19
BRSH N2
ADD R18,R19
BREQ N3
RJMP N4
N3:
LDI R16,1
BREQ N5
N4:
LDI R16,0
N5:
JMP EXT

L4:
MOV R23,R21
CALL CHECK
JMP EXT

L5:
MOV R18,R21
MOV R19,R22
SUB R18,R19
BRSH N10
MOV R18,R22
MOV R19,R21
RJMP N11
N10:
MOV R18,R21
MOV R19,R22
MOV R23,R19
N11:
MOV R24,R18
INC R23
SUB R24,R23
BREQ N12
CALL CHECK
TST R16
BREQ N11
MOV R16,R23
JMP EXT
N12:
LDI R16,0
JMP EXT

L6:
MOV R18,R21
MOV R19,R22
SUB R18,R19
BRSH N13
MOV R18,R22
MOV R19,R21
RJMP N14
N13:
MOV R18,R21
MOV R19,R22
MOV R23,R18
N14:
MOV R24,R19
DEC R23
SUB R24,R23
BREQ N15
CALL CHECK
TST R16
BREQ N14
MOV R16,R23
JMP EXT
N15:
LDI R16,0
JMP EXT

L7:
MOV R18,R21
MOV R19,R22
SUB R18,R19
BRSH N16
MOV R18,R22
MOV R19,R21
RJMP N17
N16:
MOV R18,R21
MOV R19,R22
MOV R23,R19
N17:
MOV R24,R18
INC R23
SUB R24,R23
BREQ N18
CALL CHECK2
TST R16
BRNE N17
CALL CHECK3
TST R16
BREQ N17
MOV R16,R23
JMP EXT
N18:
LDI R16,0
JMP EXT

L8:
MOV R18,R21
MOV R19,R22
SUB R18,R19
BRSH N19
MOV R18,R22
MOV R19,R21
RJMP N20
N19:
MOV R18,R21
MOV R19,R22
MOV R23,R18
N20:
MOV R24,R19
DEC R23
SUB R24,R23
BREQ N21
CALL CHECK2
TST R16
BRNE N20
CALL CHECK7
TST R16
BREQ N20
MOV R16,R23
JMP EXT
N21:
LDI R16,0
JMP EXT

EXT: RET

CHECK:
MOV R20,R23
Z2:
MOV R24,R23
DEC R20
DEC R20
BREQ Z3
INC R20
Z0:
SUB R24,R20
BRSH Z0
ADD R24,R20
BREQ Z1
RJMP Z2
Z1:
LDI R16,0
RET
Z3:
LDI R16,1
RET

CHECK2:
MOV R25,R23
LDI R20,2
Y0:
SUB R25,R20
BRSH Y0
ADD R25,R20
BREQ Y1
LDI R16,0
RET
Y1:
LDI R16,1
RET

CHECK3:
MOV R25,R23
LDI R20,3
X0:
SUB R25,R20
BRSH X0
ADD R25,R20
BREQ X1
LDI R16,0
RET
X1:
LDI R16,1
RET

CHECK7:
MOV R25,R23
LDI R20,7
W0:
SUB R25,R20
BRSH W0
ADD R25,R20
BREQ W1
LDI R16,0
RET
W1:
LDI R16,1
RET